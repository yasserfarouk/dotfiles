#!/usr/bin/env zsh
# load the correct .inputrc file
source ~/.exports
source ~/.zshenv
source ~/.z/z.sh

autoload -U promptinit; promptinit
unset file
# zstyle ':completion:*:*:git:*' script $HOME/.ysupport/git-completion.bash

source ~/antigen/antigen.zsh
#antigen use oh-my-zsh
antigen bundle git
antigen bundle pip
antigen bundle zsh-users/zsh-syntax-highlighting
antigen bundle zsh-users/zsh-autosuggestions
#antigen bundle marzocchi/zsh-notify
antigen bundle mafredri/zsh-async
antigen bundle sindresorhus/pure
antigen apply


# zstyle ':notify:*' command-complete-timeout 5
# zstyle ':notify:*' error-icon "https://media3.giphy.com/media/10ECejNtM1GyRy/200_s.gif"
# zstyle ':notify:*' error-title "Fail"
# zstyle ':notify:*' success-icon "https://s-media-cache-ak0.pinimg.com/564x/b5/5a/18/b55a1805f5650495a74202279036ecd2.jpg"
# zstyle ':notify:*' success-title "Success"
#

export NVM_DIR="$HOME/.nvm"
[ -s "$NVM_DIR/nvm.sh" ] && \. "$NVM_DIR/nvm.sh"  # This loads nvm
[ -s "$NVM_DIR/bash_completion" ] && \. "$NVM_DIR/bash_completion"  # This loads nvm bash_completion

#export N_PREFIX="$HOME/n"; [[ :$PATH: == *":$N_PREFIX/bin:"* ]] || PATH+=":$N_PREFIX/bin"  # Added by n-install (see http://git.io/n-install-repo).


# [[ -e "$HOME/anaconda/bin/activate" ]] && source "$HOME/anaconda/bin/activate"
# [[ -e "$HOME/anaconda3/bin/activate" ]] && source "$HOME/anaconda3/bin/activate"

# Better searching in command mode
bindkey -M vicmd '?' history-incremental-search-backward
bindkey -M vicmd '/' history-incremental-search-forward

# bindkey -m vicmd "^[oa" up-line-or-beginning-search
# bindkey -m vicmd "^[ob" down-line-or-beginning-search
# bindkey -m vicmd "^[0a" up-line-or-beginning-search
# bindkey -m vicmd "^[0b" down-line-or-beginning-search
# bindkey -m vicmd "k" up-line-or-beginning-search
# bindkey -m vicmd "j" down-line-or-beginning-search
# bindkey -m vicmd "^v" edit-command-line
# Updates editor information when the keymap changes.
function zle-keymap-select() {
  zle reset-prompt
  zle -R
}


function vi_mode_prompt_info() {
  echo "${${KEYMAP/vicmd/[% NORMAL]%}/(main|viins)/[% INSERT]%}"
}

# define right prompt, regardless of whether the theme defined it
RPS1='$(vi_mode_prompt_info)'
RPS2=$RPS1

source ~/.aliases
eval "$(direnv hook zsh)"

# pyenv
if which pyenv > /dev/null; then eval "$(pyenv init -)"; fi
# eval "$(pyenv virtualenv-init -)"
if which pyenv > /dev/null; then eval "$(pyenv virtualenv-init -)"; fi